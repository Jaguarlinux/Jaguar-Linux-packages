# Template file for 'base-files'
pkgname=base-files
version=1.0
revision=1
bootstrap=yes
depends="dulge-triggers"
short_desc="Jaguar Linux base system files"
maintainer="TigerClips1 <spongebob1966@proton.me>"
license="Public Domain"
homepage="https://ps4jaguarlinux.site/"
conf_files="
	/etc/inputrc
	/etc/profile
	/etc/hosts
	/etc/skel/.bash_profile
	/etc/skel/.bash_logout
	/etc/skel/.bashrc
	/etc/skel/.inputrc
	/etc/fstab
	/etc/nsswitch.conf"

replaces="base-directories>=0"
# New system groups
system_groups="kvm:24 plugdev:26 usbmon:27 sgx:28"

do_install() {
    vmkdir -pv ${DESTDIR}/{etc,var} ${DESTDIR}/usr/{bin,lib,sbin}

for i in bin lib sbin; do
  ln -sv usr/$i $LFS/$i
done

case $(uname -m) in
  x86_64) vmkdir -pv ${DESTDIR}/lib64 ;;
esac

# Populate 32-bit lib files on 64-bit glibc systems, for multilib.
	if [ "${DULGE_TARGET_WORDSIZE}" = "64" ] && [ "${DULGE_TARGET_LIBC}" = "glibc" ]; then
		vmkdir usr/lib32
		ln -snrf "${DESTDIR}/usr/lib32" "${DESTDIR}/lib32"
		ln -sf ../lib/locale "${DESTDIR}/usr/lib32/locale"
		vinstall "${FILESDIR}/ld.so.lib32.conf" 644 etc/ld.so.conf.d lib32.conf
	fi

vkdir -pv ${DESTDIR}/{dev,proc,sys,run}

# Install misc config files.
for f in bash_logout bash_profile bashrc inputrc; do
    vinstall ${FILESDIR}/dot_${f} 644 etc/skel .${f}
done

for f in profile hosts \
    inputrc fstab nsswitch.conf; do
    vinstall ${FILESDIR}/${f} 644 etc
done
vmkdir etc/colors
vmkdir etc/profile.d
install -m644 ${FILESDIR}/*.sh ${DESTDIR}/etc/profile.d
install -m644 ${FILESDIR}/DIR_COLORS* ${DESTDIR}/etc/colors

vbin ${FILESDIR}/lsb_release
vmkdir usr/share/licenses
vmkdir usr/lib/udev/rules.d
# os-release in the expected places
vinstall ${FILESDIR}/os-release 644 /usr/lib/
ln -s ../usr/lib/os-release ${DESTDIR}/etc/os-release

vinstall ${FILESDIR}/jaguar-release 644 /usr/lib/
ln -s ../usr/lib/jaguar-release ${DESTDIR}/etc/jaguar-release
}