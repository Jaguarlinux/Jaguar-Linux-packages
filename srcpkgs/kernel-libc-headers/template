# Template file for 'kernel-libc-headers'
pkgname=kernel-libc-headers
version=6.15.4
revision=1
bootstrap=yes
short_desc="Linux API headers for userland development"
maintainer="TigerClips1 <spongebob1966@proton.me>"
license="GPL-2.0-only"
homepage="http://www.kernel.org"
distfiles="https://github.com/crashniels/linux/archive/refs/heads/ps4-linux-6.15.y.zip"
checksum=662fcb65a97c7a0cd04833a455e193b7de41269e0271016d66a657d5bb66d598

if [ "$CHROOT_READY" ]; then
	hostmakedepends="perl"
fi

case "$DULGE_TARGET_MACHINE" in
	i686*|x86_64*) _arch="x86";;
	arm*) _arch="arm";;
	aarch64*) _arch="arm64";;
	mips*) _arch="mips";;
	ppc*) _arch="powerpc";;
	*) msg_error "$pkgname: unknown architecture.\n";;
esac

do_build() {
	make mrproper
	make ARCH="${_arch}" headers
}

do_install() {
	# the make header_install depends on rsync so just do the same thing manuall.
	vcopy usr/include usr
	find "${DESTDIR}/usr/include" -type f ! -name '*.h' -delete
}
