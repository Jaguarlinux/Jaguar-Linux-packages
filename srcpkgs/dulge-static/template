# Template file for 'dulge-static'
# NOTE: keep this package synchronized with "srcpkgs/dulge"
pkgname=dulge-static
version=0.60.5.1
revision=1
# only musl
archs="*-musl"
build_style=configure
hostmakedepends="pkg-config"
makedepends="libarchive-devel zlib-devel openssl-devel"
depends="dulge-triggers"
short_desc="DULGE package system utilities - static binaries"
maintainer="TigerClips1 <spongebob1966@proton.me>"
license="BSD-2-Clause, BSD-3-Clause, ISC"
homepage="https://github.com/Jaguarlinux/dulge"
distfiles="https://github.com/Jaguarlinux/dulge/archive/refs/tags/${version}.tar.gz"
checksum=f4c68bb1b827fa8c7f47da503e6ca455baf9ceb79cd2a2016d359c77a45ec603

do_configure() {
	./configure --prefix=/usr --sysconfdir=/etc --enable-static
}

do_install() {
	make DESTDIR=${wrksrc}/static-install install
	vmkdir usr/bin
	mv ${wrksrc}/static-install/usr/bin/*.static ${DESTDIR}/usr/bin
	for _f in /var/db/dulge/keys/* ; do
		vinstall "$_f" 0644 var/db/dulge/keys/
	done
}

post_install() {
	vlicense LICENSE
	vlicense LICENSE.3RDPARTY
}
